{
  "kind": "Event",
  "apiVersion": "audit.k8s.io/v1",
  "level": "RequestResponse",
  "auditID": "de5d98ce-8577-4ead-8d2f-e80a3c793925",
  "stage": "ResponseComplete",
  "requestURI": "/api/v1/namespaces/kube-system/secrets?limit=500",
  "verb": "list",
  "user": {
    "username": "minikube-user",
    "groups": [
      "system:masters",
      "system:authenticated"
    ],
    "extra": {
      "authentication.kubernetes.io/credential-id": [
        "X509SHA256=168ea01b702b14972dc4b1a12921826eebb0d81c5d839a0ef79c9e501a610a9d"
      ]
    }
  },
  "impersonatedUser": {
    "username": "system:serviceaccount:secure-ops:monitoring",
    "groups": [
      "system:serviceaccounts",
      "system:serviceaccounts:secure-ops",
      "system:authenticated"
    ]
  },
  "sourceIPs": [
    "192.168.49.1"
  ],
  "userAgent": "kubectl/v1.34.1 (darwin/arm64) kubernetes/93248f9",
  "objectRef": {
    "resource": "secrets",
    "namespace": "kube-system",
    "apiVersion": "v1"
  },
  "responseStatus": {
    "metadata": {},
    "status": "Failure",
    "message": "secrets is forbidden: User \"system:serviceaccount:secure-ops:monitoring\" cannot list resource \"secrets\" in API group \"\" in the namespace \"kube-system\"",
    "reason": "Forbidden",
    "details": {
      "kind": "secrets"
    },
    "code": 403
  },
  "responseObject": {
    "kind": "Status",
    "apiVersion": "v1",
    "metadata": {},
    "status": "Failure",
    "message": "secrets is forbidden: User \"system:serviceaccount:secure-ops:monitoring\" cannot list resource \"secrets\" in API group \"\" in the namespace \"kube-system\"",
    "reason": "Forbidden",
    "details": {
      "kind": "secrets"
    },
    "code": 403
  },
  "requestReceivedTimestamp": "2026-02-01T11:12:51.390509Z",
  "stageTimestamp": "2026-02-01T11:12:51.391086Z",
  "annotations": {
    "authorization.k8s.io/decision": "forbid",
    "authorization.k8s.io/reason": ""
  }
}
{
  "kind": "Event",
  "apiVersion": "audit.k8s.io/v1",
  "level": "Metadata",
  "auditID": "04c48988-72f6-4226-8646-9c6c79a615fb",
  "stage": "RequestReceived",
  "requestURI": "/api/v1/namespaces/kube-system/pods/coredns-66bc5c9577-bzszf/exec?command=cat&command=%2Fetc%2Fresolv.conf&container=coredns&stderr=true&stdout=true",
  "verb": "get",
  "user": {
    "username": "minikube-user",
    "groups": [
      "system:masters",
      "system:authenticated"
    ],
    "extra": {
      "authentication.kubernetes.io/credential-id": [
        "X509SHA256=168ea01b702b14972dc4b1a12921826eebb0d81c5d839a0ef79c9e501a610a9d"
      ]
    }
  },
  "sourceIPs": [
    "192.168.49.1"
  ],
  "userAgent": "kubectl/v1.34.1 (darwin/arm64) kubernetes/93248f9",
  "objectRef": {
    "resource": "pods",
    "namespace": "kube-system",
    "name": "coredns-66bc5c9577-bzszf",
    "apiVersion": "v1",
    "subresource": "exec"
  },
  "requestReceivedTimestamp": "2026-02-01T11:12:51.534392Z",
  "stageTimestamp": "2026-02-01T11:12:51.534392Z"
}
{
  "kind": "Event",
  "apiVersion": "audit.k8s.io/v1",
  "level": "Metadata",
  "auditID": "04c48988-72f6-4226-8646-9c6c79a615fb",
  "stage": "ResponseStarted",
  "requestURI": "/api/v1/namespaces/kube-system/pods/coredns-66bc5c9577-bzszf/exec?command=cat&command=%2Fetc%2Fresolv.conf&container=coredns&stderr=true&stdout=true",
  "verb": "get",
  "user": {
    "username": "minikube-user",
    "groups": [
      "system:masters",
      "system:authenticated"
    ],
    "extra": {
      "authentication.kubernetes.io/credential-id": [
        "X509SHA256=168ea01b702b14972dc4b1a12921826eebb0d81c5d839a0ef79c9e501a610a9d"
      ]
    }
  },
  "sourceIPs": [
    "192.168.49.1"
  ],
  "userAgent": "kubectl/v1.34.1 (darwin/arm64) kubernetes/93248f9",
  "objectRef": {
    "resource": "pods",
    "namespace": "kube-system",
    "name": "coredns-66bc5c9577-bzszf",
    "apiVersion": "v1",
    "subresource": "exec"
  },
  "responseStatus": {
    "metadata": {},
    "code": 101
  },
  "requestReceivedTimestamp": "2026-02-01T11:12:51.534392Z",
  "stageTimestamp": "2026-02-01T11:12:51.535272Z",
  "annotations": {
    "authorization.k8s.io/decision": "allow",
    "authorization.k8s.io/reason": ""
  }
}
{
  "kind": "Event",
  "apiVersion": "audit.k8s.io/v1",
  "level": "Metadata",
  "auditID": "04c48988-72f6-4226-8646-9c6c79a615fb",
  "stage": "ResponseComplete",
  "requestURI": "/api/v1/namespaces/kube-system/pods/coredns-66bc5c9577-bzszf/exec?command=cat&command=%2Fetc%2Fresolv.conf&container=coredns&stderr=true&stdout=true",
  "verb": "get",
  "user": {
    "username": "minikube-user",
    "groups": [
      "system:masters",
      "system:authenticated"
    ],
    "extra": {
      "authentication.kubernetes.io/credential-id": [
        "X509SHA256=168ea01b702b14972dc4b1a12921826eebb0d81c5d839a0ef79c9e501a610a9d"
      ]
    }
  },
  "sourceIPs": [
    "192.168.49.1"
  ],
  "userAgent": "kubectl/v1.34.1 (darwin/arm64) kubernetes/93248f9",
  "objectRef": {
    "resource": "pods",
    "namespace": "kube-system",
    "name": "coredns-66bc5c9577-bzszf",
    "apiVersion": "v1",
    "subresource": "exec"
  },
  "responseStatus": {
    "metadata": {},
    "code": 101
  },
  "requestReceivedTimestamp": "2026-02-01T11:12:51.534392Z",
  "stageTimestamp": "2026-02-01T11:12:51.594060Z",
  "annotations": {
    "authorization.k8s.io/decision": "allow",
    "authorization.k8s.io/reason": ""
  }
}
{
  "kind": "Event",
  "apiVersion": "audit.k8s.io/v1",
  "level": "RequestResponse",
  "auditID": "758b3a3c-b696-4894-a64f-72d23535dd79",
  "stage": "ResponseComplete",
  "requestURI": "/api/v1/namespaces/secure-ops/pods?fieldManager=kubectl-client-side-apply&fieldValidation=Strict",
  "verb": "create",
  "user": {
    "username": "minikube-user",
    "groups": [
      "system:masters",
      "system:authenticated"
    ],
    "extra": {
      "authentication.kubernetes.io/credential-id": [
        "X509SHA256=168ea01b702b14972dc4b1a12921826eebb0d81c5d839a0ef79c9e501a610a9d"
      ]
    }
  },
  "sourceIPs": [
    "192.168.49.1"
  ],
  "userAgent": "kubectl/v1.34.1 (darwin/arm64) kubernetes/93248f9",
  "objectRef": {
    "resource": "pods",
    "namespace": "secure-ops",
    "name": "privileged-pod",
    "apiVersion": "v1"
  },
  "responseStatus": {
    "metadata": {},
    "code": 201
  },
  "requestObject": {
    "kind": "Pod",
    "apiVersion": "v1",
    "metadata": {
      "name": "privileged-pod",
      "namespace": "secure-ops",
      "annotations": {
        "kubectl.kubernetes.io/last-applied-configuration": "{\"apiVersion\":\"v1\",\"kind\":\"Pod\",\"metadata\":{\"annotations\":{},\"name\":\"privileged-pod\",\"namespace\":\"secure-ops\"},\"spec\":{\"containers\":[{\"command\":[\"sleep\",\"3600\"],\"image\":\"alpine\",\"name\":\"pwn\",\"securityContext\":{\"privileged\":true}}],\"restartPolicy\":\"Never\"}}\n"
      }
    },
    "spec": {
      "containers": [
        {
          "name": "pwn",
          "image": "alpine",
          "command": [
            "sleep",
            "3600"
          ],
          "resources": {},
          "terminationMessagePath": "/dev/termination-log",
          "terminationMessagePolicy": "File",
          "imagePullPolicy": "Always",
          "securityContext": {
            "privileged": true
          }
        }
      ],
      "restartPolicy": "Never",
      "terminationGracePeriodSeconds": 30,
      "dnsPolicy": "ClusterFirst",
      "securityContext": {},
      "schedulerName": "default-scheduler",
      "enableServiceLinks": true
    },
    "status": {}
  },
  "responseObject": {
    "kind": "Pod",
    "apiVersion": "v1",
    "metadata": {
      "name": "privileged-pod",
      "namespace": "secure-ops",
      "uid": "42140b22-e892-4346-bb81-dd67da43e136",
      "resourceVersion": "32314",
      "generation": 1,
      "creationTimestamp": "2026-02-01T11:12:51Z",
      "annotations": {
        "kubectl.kubernetes.io/last-applied-configuration": "{\"apiVersion\":\"v1\",\"kind\":\"Pod\",\"metadata\":{\"annotations\":{},\"name\":\"privileged-pod\",\"namespace\":\"secure-ops\"},\"spec\":{\"containers\":[{\"command\":[\"sleep\",\"3600\"],\"image\":\"alpine\",\"name\":\"pwn\",\"securityContext\":{\"privileged\":true}}],\"restartPolicy\":\"Never\"}}\n"
      },
      "managedFields": [
        {
          "manager": "kubectl-client-side-apply",
          "operation": "Update",
          "apiVersion": "v1",
          "time": "2026-02-01T11:12:51Z",
          "fieldsType": "FieldsV1",
          "fieldsV1": {
            "f:metadata": {
              "f:annotations": {
                ".": {},
                "f:kubectl.kubernetes.io/last-applied-configuration": {}
              }
            },
            "f:spec": {
              "f:containers": {
                "k:{\"name\":\"pwn\"}": {
                  ".": {},
                  "f:command": {},
                  "f:image": {},
                  "f:imagePullPolicy": {},
                  "f:name": {},
                  "f:resources": {},
                  "f:securityContext": {
                    ".": {},
                    "f:privileged": {}
                  },
                  "f:terminationMessagePath": {},
                  "f:terminationMessagePolicy": {}
                }
              },
              "f:dnsPolicy": {},
              "f:enableServiceLinks": {},
              "f:restartPolicy": {},
              "f:schedulerName": {},
              "f:securityContext": {},
              "f:terminationGracePeriodSeconds": {}
            }
          }
        }
      ]
    },
    "spec": {
      "volumes": [
        {
          "name": "kube-api-access-lbdvj",
          "projected": {
            "sources": [
              {
                "serviceAccountToken": {
                  "expirationSeconds": 3607,
                  "path": "token"
                }
              },
              {
                "configMap": {
                  "name": "kube-root-ca.crt",
                  "items": [
                    {
                      "key": "ca.crt",
                      "path": "ca.crt"
                    }
                  ]
                }
              },
              {
                "downwardAPI": {
                  "items": [
                    {
                      "path": "namespace",
                      "fieldRef": {
                        "apiVersion": "v1",
                        "fieldPath": "metadata.namespace"
                      }
                    }
                  ]
                }
              }
            ],
            "defaultMode": 420
          }
        }
      ],
      "containers": [
        {
          "name": "pwn",
          "image": "alpine",
          "command": [
            "sleep",
            "3600"
          ],
          "resources": {},
          "volumeMounts": [
            {
              "name": "kube-api-access-lbdvj",
              "readOnly": true,
              "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
            }
          ],
          "terminationMessagePath": "/dev/termination-log",
          "terminationMessagePolicy": "File",
          "imagePullPolicy": "Always",
          "securityContext": {
            "privileged": true
          }
        }
      ],
      "restartPolicy": "Never",
      "terminationGracePeriodSeconds": 30,
      "dnsPolicy": "ClusterFirst",
      "serviceAccountName": "default",
      "serviceAccount": "default",
      "securityContext": {},
      "schedulerName": "default-scheduler",
      "tolerations": [
        {
          "key": "node.kubernetes.io/not-ready",
          "operator": "Exists",
          "effect": "NoExecute",
          "tolerationSeconds": 300
        },
        {
          "key": "node.kubernetes.io/unreachable",
          "operator": "Exists",
          "effect": "NoExecute",
          "tolerationSeconds": 300
        }
      ],
      "priority": 0,
      "enableServiceLinks": true,
      "preemptionPolicy": "PreemptLowerPriority"
    },
    "status": {
      "phase": "Pending",
      "qosClass": "BestEffort"
    }
  },
  "requestReceivedTimestamp": "2026-02-01T11:12:51.460711Z",
  "stageTimestamp": "2026-02-01T11:12:51.462226Z",
  "annotations": {
    "authorization.k8s.io/decision": "allow",
    "authorization.k8s.io/reason": "",
    "pod-security.kubernetes.io/enforce-policy": "privileged:latest"
  }
}
{
  "kind": "Event",
  "apiVersion": "audit.k8s.io/v1",
  "level": "Metadata",
  "auditID": "5c6b2db6-0ae1-4cda-8530-26ab7bcd0da3",
  "stage": "RequestReceived",
  "requestURI": "/apis/rbac.authorization.k8s.io/v1/namespaces/kube-system/rolebindings?timeout=10s",
  "verb": "create",
  "user": {
    "username": "kubernetes-admin",
    "groups": [
      "kubeadm:cluster-admins",
      "system:authenticated"
    ],
    "extra": {
      "authentication.kubernetes.io/credential-id": [
        "X509SHA256=6781851569d4c59b85b387339580c77ed6b5ba77a35b2b7d003db7d8b21372d0"
      ]
    }
  },
  "sourceIPs": [
    "192.168.49.2"
  ],
  "userAgent": "kubeadm/v1.34.0 (linux/arm64) kubernetes/f28b4c9",
  "objectRef": {
    "resource": "rolebindings",
    "namespace": "kube-system",
    "apiGroup": "rbac.authorization.k8s.io",
    "apiVersion": "v1"
  },
  "requestReceivedTimestamp": "2026-02-01T11:04:36.741193Z",
  "stageTimestamp": "2026-02-01T11:04:36.741193Z"
}
{
  "kind": "Event",
  "apiVersion": "audit.k8s.io/v1",
  "level": "Metadata",
  "auditID": "5c6b2db6-0ae1-4cda-8530-26ab7bcd0da3",
  "stage": "ResponseComplete",
  "requestURI": "/apis/rbac.authorization.k8s.io/v1/namespaces/kube-system/rolebindings?timeout=10s",
  "verb": "create",
  "user": {
    "username": "kubernetes-admin",
    "groups": [
      "kubeadm:cluster-admins",
      "system:authenticated"
    ],
    "extra": {
      "authentication.kubernetes.io/credential-id": [
        "X509SHA256=6781851569d4c59b85b387339580c77ed6b5ba77a35b2b7d003db7d8b21372d0"
      ]
    }
  },
  "sourceIPs": [
    "192.168.49.2"
  ],
  "userAgent": "kubeadm/v1.34.0 (linux/arm64) kubernetes/f28b4c9",
  "objectRef": {
    "resource": "rolebindings",
    "namespace": "kube-system",
    "name": "kube-proxy",
    "apiGroup": "rbac.authorization.k8s.io",
    "apiVersion": "v1"
  },
  "responseStatus": {
    "metadata": {},
    "status": "Failure",
    "message": "rolebindings.rbac.authorization.k8s.io \"kube-proxy\" already exists",
    "reason": "AlreadyExists",
    "details": {
      "name": "kube-proxy",
      "group": "rbac.authorization.k8s.io",
      "kind": "rolebindings"
    },
    "code": 409
  },
  "requestReceivedTimestamp": "2026-02-01T11:04:36.741193Z",
  "stageTimestamp": "2026-02-01T11:04:36.742367Z",
  "annotations": {
    "authorization.k8s.io/decision": "allow",
    "authorization.k8s.io/reason": "RBAC: allowed by ClusterRoleBinding \"kubeadm:cluster-admins\" of ClusterRole \"cluster-admin\" to Group \"kubeadm:cluster-admins\""
  }
}
{
  "kind": "Event",
  "apiVersion": "audit.k8s.io/v1",
  "level": "Metadata",
  "auditID": "a8a52da1-8838-449b-abae-976574c8a9a5",
  "stage": "RequestReceived",
  "requestURI": "/apis/rbac.authorization.k8s.io/v1/namespaces/secure-ops/rolebindings?fieldManager=kubectl-client-side-apply&fieldValidation=Strict",
  "verb": "create",
  "user": {
    "username": "minikube-user",
    "groups": [
      "system:masters",
      "system:authenticated"
    ],
    "extra": {
      "authentication.kubernetes.io/credential-id": [
        "X509SHA256=168ea01b702b14972dc4b1a12921826eebb0d81c5d839a0ef79c9e501a610a9d"
      ]
    }
  },
  "sourceIPs": [
    "192.168.49.1"
  ],
  "userAgent": "kubectl/v1.34.1 (darwin/arm64) kubernetes/93248f9",
  "objectRef": {
    "resource": "rolebindings",
    "namespace": "secure-ops",
    "apiGroup": "rbac.authorization.k8s.io",
    "apiVersion": "v1"
  },
  "requestReceivedTimestamp": "2026-02-01T11:12:51.663091Z",
  "stageTimestamp": "2026-02-01T11:12:51.663091Z"
}
{
  "kind": "Event",
  "apiVersion": "audit.k8s.io/v1",
  "level": "Metadata",
  "auditID": "a8a52da1-8838-449b-abae-976574c8a9a5",
  "stage": "ResponseComplete",
  "requestURI": "/apis/rbac.authorization.k8s.io/v1/namespaces/secure-ops/rolebindings?fieldManager=kubectl-client-side-apply&fieldValidation=Strict",
  "verb": "create",
  "user": {
    "username": "minikube-user",
    "groups": [
      "system:masters",
      "system:authenticated"
    ],
    "extra": {
      "authentication.kubernetes.io/credential-id": [
        "X509SHA256=168ea01b702b14972dc4b1a12921826eebb0d81c5d839a0ef79c9e501a610a9d"
      ]
    }
  },
  "sourceIPs": [
    "192.168.49.1"
  ],
  "userAgent": "kubectl/v1.34.1 (darwin/arm64) kubernetes/93248f9",
  "objectRef": {
    "resource": "rolebindings",
    "namespace": "secure-ops",
    "name": "escalate-binding",
    "apiGroup": "rbac.authorization.k8s.io",
    "apiVersion": "v1"
  },
  "responseStatus": {
    "metadata": {},
    "code": 201
  },
  "requestReceivedTimestamp": "2026-02-01T11:12:51.663091Z",
  "stageTimestamp": "2026-02-01T11:12:51.664163Z",
  "annotations": {
    "authorization.k8s.io/decision": "allow",
    "authorization.k8s.io/reason": ""
  }
}
